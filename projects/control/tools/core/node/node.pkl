import "../application/application.pkl"
import "../../../shared/applications/infrastructure/infraApplication.pkl"
import "../../../shared/applications/buffer/bufferApplication.pkl"
import "../endianness/endianness.pkl"

open class Node {
    /// Configuration settings for the buffer application that
    /// will listen to channels on this node and store them. This buffers
    /// most state, and can ingest control or event based telemetry.
    buffer: bufferApplication.BufferApplication? = null

    /// Configuration settings for the infra application that manages anything
    /// related to SpaceY infra, such as resource serving or channel management.
    infra: infraApplication.InfraApplication? = null

    endianness: endianness.Endianness = "little"

    /// Other applications
    applications: Set<application.Application>(length > 0)

    function allApplications(): Set<application.Application> = applications + Set(buffer, infra).filter((app) -> !(app is Null))
}

nice = new Node {
    applications = Set(new application.Application { name = "shoot" })
}